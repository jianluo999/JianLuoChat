import { defineStore } from 'pinia'
import { ref, computed, shallowRef, shallowReactor, nextTick } from 'vue'

// å¿«é€Ÿç™»å½•MatrixæœåŠ¡ - ä¼˜åŒ–ç‰ˆæœ¬
export const useMatrixQuickLoginStore = defineStore('matrix-quick-login', () => {
  // ç®€åŒ–çŠ¶æ€ç®¡ç†
  const matrixClient = shallowRef(null)
  const connection = shallowReactor({
    connected: false,
    homeserver: 'matrix.org',
    userId: null,
    accessToken: null,
    deviceId: null,
    syncState: { isActive: false }
  })
  
  // ç®€åŒ–çŠ¶æ€
  const rooms = shallowReactor([])
  const currentRoomId = ref(null)
  const loading = ref(false)
  const error = ref(null)
  const loginComplete = ref(false)
  
  // å¿«é€Ÿç™»å½•æ–¹æ³•
  const quickLogin = async (username, password, homeserver = 'matrix.org') => {
    try {
      loading.value = true
      error.value = null
      
      console.log(`ðŸš€ å¿«é€Ÿç™»å½•: ${username}@${homes