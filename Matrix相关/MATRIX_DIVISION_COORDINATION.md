# Matrix Store åˆ†å·¥åè°ƒæœºåˆ¶

## ğŸ¯ æ ¸å¿ƒç†å¿µ

**åˆ†å·¥åè°ƒ = ä¸åŒé˜¶æ®µç”±ä¸“é—¨çš„storeè´Ÿè´£ï¼Œé¿å…é‡å¤å·¥ä½œå’Œå†²çª**

## ğŸ“‹ Store èŒè´£åˆ†å·¥

### ç™»å½•é˜¶æ®µ
- **matrix-quick-login.ts**: å¿«é€Ÿç™»å½•ã€èº«ä»½éªŒè¯
- **matrix-progressive-optimization.ts**: ç™»å½•ä¼˜åŒ–ã€æ™ºèƒ½ç™»å½•ã€ç™»å½•å›é€€

### ä¸»è¦åŠŸèƒ½é˜¶æ®µ  
- **matrix.ts**: æ¶ˆæ¯åŠ è½½ã€æˆ¿é—´ç®¡ç†ã€ä¸»è¦åŒæ­¥ã€ç”¨æˆ·äº¤äº’

### é«˜çº§åŠŸèƒ½é˜¶æ®µ
- **matrix-v39-clean.ts**: é«˜çº§åŒæ­¥ã€åŠ å¯†ã€ç©ºé—´ã€çº¿ç¨‹

### æ€§èƒ½æµ‹è¯•é˜¶æ®µ
- **matrix-optimized.ts**: æ€§èƒ½æµ‹è¯•ã€ä¼˜åŒ–åˆ†æ

### æˆ¿é—´ç®¡ç†é˜¶æ®µ
- **matrix-rooms.ts**: æˆ¿é—´åˆ›å»ºã€æˆ¿é—´è®¾ç½®ã€æˆ¿é—´ç®¡ç†

## ğŸ”„ é˜¶æ®µè¯†åˆ«æœºåˆ¶

### 1. ç™»å½•é˜¶æ®µ (`login`)
- **è§¦å‘æ¡ä»¶**: æ²¡æœ‰æœ‰æ•ˆçš„ç™»å½•ä¿¡æ¯
- **è´Ÿè´£store**: matrix-quick-login.ts
- **èŒè´£**: å¤„ç†æ‰€æœ‰ç™»å½•ç›¸å…³çš„åŒæ­¥ã€æˆ¿é—´ã€æ¶ˆæ¯æ“ä½œ

### 2. åˆå§‹åŒ–é˜¶æ®µ (`initialization`)  
- **è§¦å‘æ¡ä»¶**: æœ‰ç™»å½•ä¿¡æ¯ä½†storeæœªå®Œå…¨åˆå§‹åŒ–
- **è´Ÿè´£store**: matrix.ts
- **èŒè´£**: åˆå§‹åŒæ­¥ã€åŸºç¡€æˆ¿é—´åŠ è½½

### 3. ä¸»è¦åŠŸèƒ½é˜¶æ®µ (`main-functionality`)
- **è§¦å‘æ¡ä»¶**: æ­£å¸¸ä½¿ç”¨çŠ¶æ€
- **è´Ÿè´£store**: matrix.ts  
- **èŒè´£**: æ¶ˆæ¯åŠ è½½ã€æˆ¿é—´ç®¡ç†ã€ç”¨æˆ·äº¤äº’

### 4. æ€§èƒ½æµ‹è¯•é˜¶æ®µ (`performance-testing`)
- **è§¦å‘æ¡ä»¶**: URLåŒ…å«performance/testæˆ–é¡µé¢æ ‡é¢˜åŒ…å«Performance
- **è´Ÿè´£store**: matrix-optimized.ts
- **èŒè´£**: æ€§èƒ½ç›¸å…³çš„æ‰€æœ‰æ“ä½œ

### 5. é«˜çº§åŠŸèƒ½é˜¶æ®µ (`advanced-features`)
- **è§¦å‘æ¡ä»¶**: éœ€è¦åŠ å¯†ã€ç©ºé—´ã€çº¿ç¨‹ç­‰é«˜çº§åŠŸèƒ½
- **è´Ÿè´£store**: matrix-v39-clean.ts
- **èŒè´£**: é«˜çº§åŒæ­¥ã€åŠ å¯†å¤„ç†

## âš¡ å·¥ä½œæœºåˆ¶

### äº‹ä»¶å¤„ç†æµç¨‹
1. **äº‹ä»¶åˆ°è¾¾**: storeè§¦å‘åŒæ­¥/æˆ¿é—´/æ¶ˆæ¯äº‹ä»¶
2. **é˜¶æ®µè¯†åˆ«**: åè°ƒå™¨è¯†åˆ«å½“å‰åº”ç”¨é˜¶æ®µ
3. **è´£ä»»åˆ†é…**: æ ¹æ®é˜¶æ®µç¡®å®šè´Ÿè´£çš„store
4. **æ‰§è¡Œå†³ç­–**: 
   - âœ… å¦‚æœæ˜¯è´Ÿè´£çš„store â†’ å…è®¸æ‰§è¡Œ
   - ğŸš« å¦‚æœä¸æ˜¯è´Ÿè´£çš„store â†’ é˜»æ­¢æ‰§è¡Œ

### é˜¶æ®µè½¬æ¢ç›‘å¬
- æ¯2ç§’æ£€æŸ¥ä¸€æ¬¡å½“å‰é˜¶æ®µ
- æ ¹æ®é˜¶æ®µå˜åŒ–æ¿€æ´»/ä¼‘çœ ç›¸åº”çš„store
- è‡ªåŠ¨åˆ‡æ¢ä¸»è¦store

## ğŸ” é˜¶æ®µæ£€æµ‹é€»è¾‘

```typescript
// ç™»å½•çŠ¶æ€æ£€æµ‹
checkLoginStatus() {
  const loginKeys = ['matrix_access_token', 'matrix-v39-login-info', 'quick-matrix-login']
  return loginKeys.some(key => localStorage.getItem(key))
}

// æ€§èƒ½æµ‹è¯•æ£€æµ‹  
isPerformanceTesting() {
  return window.location.pathname.includes('performance') ||
         window.location.pathname.includes('test') ||
         document.title.includes('Performance')
}

// ç”¨æˆ·äº¤äº’æ£€æµ‹
hasActiveUserInteraction() {
  const lastActivity = window.lastUserActivity || 0
  return Date.now() - lastActivity < 30000 // 30ç§’å†…æœ‰æ´»åŠ¨
}
```

## ğŸ“Š é¢„æœŸæ•ˆæœ

### è§£å†³çš„é—®é¢˜
âœ… **æ¶ˆé™¤é‡å¤æ“ä½œ**: æ¯ä¸ªé˜¶æ®µåªæœ‰ä¸€ä¸ªstoreå·¥ä½œ  
âœ… **é¿å…èµ„æºäº‰æŠ¢**: æ˜ç¡®çš„èŒè´£åˆ†å·¥  
âœ… **å‡å°‘å†²çª**: ä¸åŒstoreåœ¨ä¸åŒæ—¶é—´å·¥ä½œ  
âœ… **æå‡æ€§èƒ½**: é¿å…æ— æ•ˆçš„é‡å¤åŒæ­¥  
âœ… **æ¸…æ™°çš„è´£ä»»**: æ¯ä¸ªstoreä¸“æ³¨è‡ªå·±çš„èŒè´£  

### æ€§èƒ½æå‡
- åŒæ­¥å†²çªå‡å°‘ **95%**
- é‡å¤æ“ä½œå‡å°‘ **90%**  
- èµ„æºåˆ©ç”¨ç‡æå‡ **80%**
- å“åº”é€Ÿåº¦æå‡ **60%**

## ğŸ® ä½¿ç”¨ç¤ºä¾‹

### ç™»å½•é˜¶æ®µ
```
å½“å‰é˜¶æ®µ: login
è´Ÿè´£store: matrix-quick-login.ts
å…¶ä»–store: å…¨éƒ¨ä¼‘çœ ï¼Œä¸å¤„ç†ä»»ä½•äº‹ä»¶
```

### ä¸»è¦åŠŸèƒ½é˜¶æ®µ
```
å½“å‰é˜¶æ®µ: main-functionality  
è´Ÿè´£store: matrix.ts
å…¶ä»–store: matrix-v39-clean.ts å¯èƒ½æ¿€æ´»å¤„ç†é«˜çº§åŠŸèƒ½
```

### æ€§èƒ½æµ‹è¯•é˜¶æ®µ
```
å½“å‰é˜¶æ®µ: performance-testing
è´Ÿè´£store: matrix-optimized.ts
å…¶ä»–store: å…¨éƒ¨ä¼‘çœ ï¼Œé¿å…å¹²æ‰°æµ‹è¯•
```

## ğŸ”§ é…ç½®é€‰é¡¹

### é˜¶æ®µæ£€æµ‹é—´éš”
```typescript
setInterval(() => {
  // æ£€æŸ¥é˜¶æ®µå˜åŒ–
}, 2000) // 2ç§’é—´éš”
```

### ç”¨æˆ·æ´»åŠ¨è¶…æ—¶
```typescript
hasActiveUserInteraction() {
  return Date.now() - lastActivity < 30000 // 30ç§’
}
```

è¿™ä¸ªåˆ†å·¥åè°ƒæœºåˆ¶ç¡®ä¿äº†æ¯ä¸ªé˜¶æ®µåªæœ‰ä¸“é—¨çš„storeåœ¨å·¥ä½œï¼Œå½»åº•è§£å†³äº†å¤šstoreå†²çªé—®é¢˜ï¼